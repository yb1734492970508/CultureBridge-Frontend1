# CultureBridge 批处理自动化系统使用指南

## 简介

CultureBridge 批处理自动化系统是一个专为多账号协作开发设计的高效工具，它允许您通过单一主控账号协调多个账号同时进行开发工作，并自动控制每个账号的积分消耗。

本指南将帮助您完成系统的安装、配置和使用全过程。

## 系统要求

- Node.js v14.0.0 或更高版本
- npm v6.0.0 或更高版本
- Git 2.30.0 或更高版本
- GitHub 账号和访问令牌

## 安装步骤

1. 克隆批处理系统代码：

```bash
git clone https://github.com/yb1734492970508/CultureBridge-Frontend1.git
cd CultureBridge
```

2. 安装依赖：

```bash
cd src/batch-system
npm install commander chalk figlet ora
```

3. 设置执行权限：

```bash
chmod +x main.js
```

## 初始化系统

首次使用批处理系统时，需要进行初始化设置：

1. 运行初始化命令：

```bash
node main.js
```

2. 按照提示输入以下信息：
   - 主控账号识别码（您选择的主账号）
   - GitHub 访问令牌
   - GitHub 仓库（默认为 yb1734492970508/CultureBridge-Frontend1）
   - 每个账号每日最大积分消耗（默认为 300）

3. 设置主密码：
   - 这个密码将用于加密存储所有账号的 API 密钥
   - 请选择一个强密码并妥善保管，忘记密码将无法恢复已存储的 API 密钥

## 添加账号 API 密钥

系统初始化后，您需要添加所有参与协作的账号 API 密钥：

### 单个添加

1. 在主菜单中选择 `1. 添加账号API密钥`
2. 输入账号识别码（如 CB-DESIGN, CB-FRONTEND 等）
3. 输入该账号的 API 密钥
4. 重复以上步骤添加所有账号

### 批量添加

1. 在主菜单中选择 `2. 批量添加账号API密钥`
2. 输入要添加的账号数量
3. 按照提示依次输入每个账号的识别码和 API 密钥

## 查看账号列表

您可以随时查看已添加的账号列表：

1. 在主菜单中选择 `3. 查看账号列表`
2. 系统将显示所有已添加账号的识别码，并标记主控账号

## 启动批处理系统

完成账号添加后，您可以启动批处理系统：

1. 在主菜单中选择 `4. 启动批处理系统`
2. 确认启动
3. 系统将自动：
   - 加载预定义任务或使用默认任务
   - 根据任务优先级和依赖关系分配任务
   - 确保每个账号的积分消耗不超过设定上限
   - 生成任务分配报告

## 重置每日积分消耗

每天开始新的工作前，您应该重置所有账号的积分消耗计数：

1. 在主菜单中选择 `5. 重置每日积分消耗`
2. 确认重置操作

## 命令行选项

批处理系统支持以下命令行选项，方便快速操作：

- `-i, --init`: 初始化系统
- `-a, --add-account`: 添加账号 API 密钥
- `-b, --bulk-add`: 批量添加账号 API 密钥
- `-l, --list`: 查看账号列表
- `-s, --start`: 启动批处理系统
- `-r, --reset`: 重置每日积分消耗

例如，您可以直接运行 `node main.js -s` 来启动批处理系统。

## 安全建议

1. **主密码保护**：
   - 使用强密码（至少12位，包含大小写字母、数字和特殊字符）
   - 不要与其他系统共用相同密码
   - 不要将密码存储在不安全的位置

2. **API 密钥管理**：
   - 为每个账号创建专用的 API 密钥
   - 设置适当的权限范围，仅授予必要权限
   - 定期轮换 API 密钥

3. **系统访问控制**：
   - 限制批处理系统的访问权限
   - 不要在公共计算机上运行系统
   - 使用完毕后退出系统

## 故障排除

### 无法解锁系统

**问题**：输入主密码后系统提示"主密码不正确，解锁失败"

**解决方案**：
- 确认输入的主密码正确，注意大小写
- 如果确认密码正确但仍无法解锁，可能是凭证文件损坏，尝试删除 `.culture-bridge/credentials.enc` 文件并重新初始化系统

### 任务分配失败

**问题**：启动批处理系统后没有任务被分配

**解决方案**：
- 检查是否有足够的账号（至少需要2个账号）
- 确认任务定义正确，特别是任务依赖关系
- 检查每个账号的积分限制是否合理

### API 密钥验证失败

**问题**：系统提示"API 密钥验证失败"

**解决方案**：
- 确认输入的 API 密钥正确
- 检查 API 密钥是否已过期或被撤销
- 确认 API 密钥具有必要的权限

## 联系支持

如果您在使用过程中遇到任何问题，或有改进建议，请通过以下方式联系我们：

- 在 GitHub 仓库提交 Issue
- 通过 Manus 平台发送消息

## 后续更新计划

我们将持续改进批处理自动化系统，计划中的功能包括：

1. 实时任务执行监控
2. 自动错误恢复机制
3. 更详细的性能分析报告
4. 更灵活的任务定义方式
5. 与其他开发工具的集成

感谢您使用 CultureBridge 批处理自动化系统！
